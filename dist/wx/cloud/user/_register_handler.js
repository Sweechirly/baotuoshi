module.exports=async function(e,a,t,s){try{const o=await a.collection("user_list").where({_openid:e.data._openid}).get();if(o.data?.length)e.code=s.REPEAT_ERROR,e.message="用户已存在，请勿重复注册",e.data=o.data[0];else{const s={_openid:e.data._openid,createTime:a.serverDate(),userInfo:t,myWorks:[],receivedWorks:[]},o=await a.collection("user_list").add({data:s});s._id=o._id,e.data=s,e.message="注册成功",console.log("register res: ",o)}}catch(a){e.code=s.SERVER_ERROR,e.message="服务器出错"}};